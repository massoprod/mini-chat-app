(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{2:function(e,t,a){e.exports={btnsWrapper:"style_btnsWrapper__kO5fY"}},22:function(e,t,a){e.exports=a(75)},27:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(19),s=a.n(r),c=(a(27),a(4)),l=a(5),i=a(7),m=a(6),u=a(8),h=Object(n.createContext)({user:null,room:null,setUser:function(){},setRoom:function(){}}),p=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).setUser=function(e){a.setState({user:e})},a.setRoom=function(e){a.setState({room:e})},a.state={user:null,room:null,setUser:a.setUser,setRoom:a.setRoom},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(h.Provider,{value:this.state},this.props.children)}}]),t}(n.Component),d=h.Consumer,b=a(21),g=a(2),f=a.n(g),C=a(10),v=a.n(C),E=a(3),N=a.n(E),y=a(20),w=a.n(y),R="v1:us1:f0ecceaa-4992-4706-813f-8237028def31",k=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={chatAction:null,userName:"",chatRoom:"",isLoading:!1,messages:[],isChatReady:!1,message:"",rooms:[]},a.handleChangeChatAction=function(e){a.setState({chatAction:e})},a.handleChangeUserName=function(e){a.setState({userName:e.target.value})},a.handleChangeChatRoom=function(e){a.setState({chatRoom:e.target.value})},a.handleUpdateMessage=function(e){a.setState({message:e.target.value})},a.connectToRoom=function(e){var t=a.props.appData;return t.user.subscribeToRoom({roomId:"".concat(e),messageLimit:100,hooks:{onMessage:function(e){a.setState({messages:[].concat(Object(b.a)(a.state.messages),[e])})}}}).then((function(e){t.setRoom(e)}))},a.createRoom=function(){a.props.appData.user.createRoom({name:a.state.chatRoom,private:!0}).then((function(e){return a.connectToRoom(e.id)})).catch(console.error)},a.handleSubmitNewChat=function(){a.setState({isLoading:!0});var e=a.state.userName;null===e||""===e.trim()?alert("Invalid userId"):v.a.post("http://localhost:5200/users",{userId:e}).then((function(){var t=new N.a.TokenProvider({url:"http://localhost:5200/authenticate"});return new N.a.ChatManager({instanceLocator:R,userId:e,tokenProvider:t}).connect().then((function(e){a.props.appData.setUser(e),a.setState({isLoading:!1,isChatReady:!0},(function(){return a.createRoom()}))}))})).catch(console.error)},a.handleSubmitJoinChat=function(){a.setState({isLoading:!0});var e=a.state.userName;v.a.post("http://localhost:5200/users",{userId:e}).then((function(){var t=new N.a.TokenProvider({url:"http://localhost:5200/authenticate"});return new N.a.ChatManager({instanceLocator:R,userId:e,tokenProvider:t}).connect().then((function(e){a.props.appData.setUser(e),a.setState({isLoading:!1,isChatReady:!0,rooms:a.props.appData.user.rooms},(function(){a.state.rooms.length>=1&&a.connectToRoom(a.state.rooms[0].id)}))}))})).catch(console.error)},a.handleSubmitMessage=function(e){e.preventDefault();var t=a.state.message,n=a.props.appData;""!==t.trim()&&(n.user.sendMessage({text:t,roomId:"".concat(n.room.id)}),a.setState({message:""}))},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.appData,t=this.state,a=t.chatAction,n=t.isLoading,r=t.userName,s=t.chatRoom,c=t.messages,l=t.message,i=t.isChatReady;return console.log("APP DATA: ",e),console.log("MESSAGES:",c),n?o.a.createElement("div",{className:f.a.btnsWrapper},o.a.createElement(w.a,{name:"ball-triangle-path",color:"#f0f0f0"})):i?o.a.createElement("div",null,c.map((function(e,t){return o.a.createElement("div",{key:"".concat(e,"-").concat(t)},e.text)})),o.a.createElement("input",{onChange:this.handleUpdateMessage,value:l}),o.a.createElement("button",{type:"button",onClick:this.handleSubmitMessage},"SUBMIT")):o.a.createElement(o.a.Fragment,null,null===a&&o.a.createElement("div",{className:f.a.btnsWrapper},o.a.createElement("button",{type:"button",className:"btn btn-primary",style:{width:200},onClick:this.handleChangeChatAction.bind(this,"join")},"Join chat"),o.a.createElement("button",{type:"button",className:"btn btn-info",style:{width:200},onClick:this.handleChangeChatAction.bind(this,"new")},"Create new chat")),"new"===a&&o.a.createElement("div",{className:f.a.btnsWrapper},o.a.createElement("h4",null,"NEW CHAT"),o.a.createElement("div",{className:"form-group",style:{width:350}},o.a.createElement("label",{htmlFor:"userName"},"Nickname"),o.a.createElement("input",{onChange:this.handleChangeUserName,value:r,type:"text",className:"form-control",id:"exampleInputEmail1",placeholder:"Nickname"})),o.a.createElement("div",{className:"form-group",style:{width:350}},o.a.createElement("label",{htmlFor:"chatName"},"Char room name"),o.a.createElement("input",{onChange:this.handleChangeChatRoom,value:s,type:"text",className:"form-control",id:"exampleInputEmail1",placeholder:"chatroom"})),o.a.createElement("button",{type:"button",className:"btn btn-success",style:{width:350},onClick:this.handleSubmitNewChat},"CREATE CHAT"),o.a.createElement("button",{type:"button",className:"btn btn-primary",style:{width:200,marginTop:30},onClick:this.handleChangeChatAction.bind(this,null)},"BACK")),"join"===a&&o.a.createElement("div",{className:f.a.btnsWrapper},o.a.createElement("h4",null,"JOIN CHAT"),o.a.createElement("div",{className:"form-group",style:{width:350}},o.a.createElement("label",{htmlFor:"userName"},"Nickname"),o.a.createElement("input",{onChange:this.handleChangeUserName,value:r,type:"text",className:"form-control",id:"exampleInputEmail1",placeholder:"Your Name"})),o.a.createElement("div",{className:"form-group",style:{width:350}},o.a.createElement("label",{htmlFor:"chatName"},"Char room name"),o.a.createElement("input",{onChange:this.handleChangeChatRoom,value:s,type:"text",className:"form-control",id:"exampleInputEmail1",placeholder:"chatroom"})),o.a.createElement("button",{type:"button",className:"btn btn-success",style:{width:350},onClick:this.handleSubmitJoinChat},"JOIN CHAT"),o.a.createElement("button",{type:"button",className:"btn btn-primary",style:{width:200,marginTop:30},onClick:this.handleChangeChatAction.bind(this,null)},"BACK")))}}]),t}(n.Component),S=function(){return o.a.createElement("div",{className:"container"},o.a.createElement(d,null,(function(e){return o.a.createElement(k,{appData:e})})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement((function(){return o.a.createElement(p,null,o.a.createElement(S,null))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[22,1,2]]]);
//# sourceMappingURL=main.917cf842.chunk.js.map